/*!
 * Testify Performance Helper
 * Tasarımı bozmadan Lighthouse metriklerini iyileştiren mikro optimizasyonlar
 * - CLS düşürme (özellikle reklam alanları + resimler)
 * - Lazy-load medya (fold altındaki img'ler)
 */
!function(){"use strict";const e={initialized:!1,init(){this.initialized||(this.initialized=!0,"complete"===document.readyState||"interactive"===document.readyState?this.onReady():document.addEventListener("DOMContentLoaded",(()=>this.onReady()),{once:!0}),window.addEventListener("load",(()=>this.onLoad()),{once:!0}))},onReady(){try{this.injectAdCss(),this.enableLazyMedia()}catch(e){console.warn("[TestifyPerf] onReady error:",e)}},onLoad(){try{this.markLoad()}catch(e){console.warn("[TestifyPerf] onLoad error:",e)}},injectAdCss(){const e=document.createElement("style");e.id="testify-perf-ads",e.textContent="\n/* Google AdSense ve genel reklam slotları için min yükseklik */\nins.adsbygoogle,\n.ad-slot,\n.ad-container {\n    display: block;\n    min-height: 120px;\n}\n\n/* Masaüstü dikey reklam / sidebar alanları için daha yüksek alan */\n@media (min-width: 768px) {\n    .ad-slot--vertical,\n    .ad-sidebar,\n    .ad-left,\n    .ad-right {\n        min-height: 600px;\n    }\n}\n",document.head.appendChild(e),console.log("[TestifyPerf] Ad alanı CLS koruması eklendi")},enableLazyMedia(){const e=window.innerHeight||800,n=n=>{if(!n||1!==n.nodeType)return;if(n.loading)return;n.getBoundingClientRect().top>1.2*e&&(n.loading="lazy");if(!(n.hasAttribute("width")||n.hasAttribute("height")||n.style.height||n.style.minHeight)){const e=n.naturalHeight||120;n.style.minHeight=e+"px"}};document.querySelectorAll("img").forEach(n);new MutationObserver((e=>{for(const t of e)t.addedNodes.forEach((e=>{1===e.nodeType&&("IMG"===e.tagName?n(e):e.querySelectorAll&&e.querySelectorAll("img").forEach(n))}))})).observe(document.documentElement,{childList:!0,subtree:!0}),console.log("[TestifyPerf] Lazy-load + img CLS koruması aktif")},markLoad(){if(!("performance"in window)||!("now"in performance))return;const e=Math.round(performance.now());performance.mark&&performance.mark("testify-perf-after-load"),console.log("[TestifyPerf] Tam yükleme süresi ~",e,"ms")}};e.init(),window.TestifyPerf=e}();
